var datatable;var datatype="";var vartype="";var step_btn="step1btn";function updateTable(){var a=url_path+"data/"+datatype+"/"+vartype;$.ajax({url:encodeURI(a),dataType:"json",type:"GET",success:function(b){datatable.clear();datatable.rows.add(b);datatable.draw()},error:function(b,d,c){alert("Unable to fetch dataset.")}});disableButtonsAtStep1()}function listSelectAction(a,b){$("#step1NextBtn").prop("disabled",false);$('input:hidden[name="datasetId"]').val(a.cell(b,0).data());$(".dataset_name").html(a.cell(b,1).data());$("#data_type").html(datatype.toLowerCase());$("#var_type").html($('input:radio[name="varTypeId"]:checked').next().text().toLowerCase())}function disableButtonsAtStep1(){$("#step1NextBtn").prop("disabled",true);$("#step2btn").prop("disabled",true);$("#step3btn").prop("disabled",true);$("#step4btn").prop("disabled",true)}function disableButtonsAtStep2(){$("#step2NextBtn").prop("disabled",true);$("#step3btn").prop("disabled",true);$("#step4btn").prop("disabled",true)}function fetchParameters(){var d=$("#algorithm :selected").val();var c=$("#score :selected").val();var e=$("#test :selected").val();var a=url_path+"param/algo/"+d;var b={};if(c!==null){b.score=c}if(e!==null){b.test=e}a=a+"?"+$.param(b);$.ajax({url:a,dataType:"json",type:"GET",success:function(h){var j=$("#params");$("#params > .form-group").remove();var g="";$.each(h,function(s,w){var r=w.text;var n=w.value;var x=w.minVal;var y=w.maxVal;var q=w.defaultVal;var k=w.numeric;var o=w.aBoolean;var z='id="'+n+'" name="'+n+'"';var m;if(k||o){m='data-ng-model="'+n+'" data-ng-init="'+n+"="+q+'"'}else{m='data-ng-model="'+n+'" data-ng-init="'+n+"='"+q+"'\""}var l;if(k){var v='<label for="'+n+'" class="control-label">'+r+"</label>";var u='<input type="number" class="form-control" min="'+x+'" max="'+y+'" '+z+m+' value="'+q+'" required="required" />';l='<div class="form-group">'+v+u+"</div>"}else{if(o){var v='<div class="checkbox"><label for="'+n+'" class="control-label">';var p;if(q){p='<input type="checkbox" '+z+m+' checked="checked" />'+r}else{p='<input type="checkbox" '+z+m+" />"+r}var t="</label></div>";l='<div class="form-group">'+v+p+t+"</div>"}else{var v="<label>"+r+"</label>";var u='<input class="form-control" '+z+m+' value="'+q+'" />';l='<div class="form-group">'+v+u+"</div>"}}g+=l});$(j).append(g);var f=$("#params_tbl > tbody");$(f).empty();var i;$.each(h,function(l,m){var k=m.text;var n=m.value;i+="<tr><td>"+k+':</td><td data-ng-bind="'+n+'" id="param_'+n+'"></td></tr>'});$(f).append(i)},error:function(f,h,g){alert(f.responseText)}});$(".algo_name").html($("#algorithm :selected").text().toLowerCase());$(".score_name").html($("#score :selected").text().toLowerCase());$(".test_name").html($("#test :selected").text().toLowerCase())}function fetchTests(b,c){if(!b){return}var a=$("#test");$.ajax({url:url_path+"test/algo/"+b+"/varType/"+c,dataType:"json",type:"GET",success:function(d){a.empty();$.each(d.options,function(e,g){var f="<option value='"+g.value+"'>"+g.text+"</option>";a.append(f)});if(a.is(":empty")){a.prop("disabled",true)}else{a.val(d.defaultValue).change();a.prop("disabled",false)}},error:function(d,f,e){alert(d.responseText)}})}function fetchScores(b,c){if(!b){return}var a=$("#score");$.ajax({url:url_path+"score/algo/"+b+"/varType/"+c,dataType:"json",type:"GET",success:function(d){a.empty();$.each(d.options,function(e,g){var f="<option value='"+g.value+"'>"+g.text+"</option>";a.append(f)});if(a.is(":empty")){a.prop("disabled",true)}else{a.val(d.defaultValue).change();a.prop("disabled",false)}},error:function(d,f,e){alert(d.responseText)}})}function fetchDescription(a){if(!a){return}$.ajax({url:url_path+"description/algo/"+a,dataType:"text",type:"GET",success:function(b){$("#description").text(b)}})}function fetchAlgorithms(b){var a=$("#algorithm");$.ajax({url:url_path+"algo/"+b+"/"+datatype,dataType:"json",type:"GET",success:function(c){a.empty();$.each(c,function(d,f){var e="<option value='"+f.value+"'>"+f.text+"</option>";a.append(e)})},error:function(c,e,d){alert(c.responseText);disableButtonsAtStep2()},complete:function(){if(a.is(":empty")){a.prop("disabled",true);$("#description").text("");disableButtonsAtStep2();var d=$("#score");d.empty();d.prop("disabled",true);var c=$("#test");d.empty();c.prop("disabled",true)}else{a.prop("disabled",false);$("#step2NextBtn").prop("disabled",false);$("#algorithm option:first").attr("selected","selected");a.trigger("change")}}})}function updateParamSummary(){$("#params").find("input").each(function(){var b="#param_"+$(this).attr("data-ng-model");var a=$(this).val();if($(this).attr("type")==="checkbox"){$(b).text($(this).prop("checked")?"yes":"no")}else{$(b).text(a)}})}$(document).ready(function(){var d=$('input:radio[name="varTypeId"]');var a=$('a[data-toggle="tab"]');var b=$("#single_datatable").DataTable({select:{style:"single"},sAjaxDataProp:"",aoColumns:[{mData:"fileId"},{mData:"title"},{mData:"creationTime"},{mData:"numOfCases"},{mData:"numOfVars"}],columnDefs:[{targets:0,visible:false,searchable:false},{render:function(e){return moment(e).format("MMM DD, YYYY hh:mm:ss A")},targets:2}],order:[[1,"asc"]]});var c=$("#multi_datatable").DataTable({select:{style:"single"},sAjaxDataProp:"",aoColumns:[{mData:"fileGroupId"},{mData:"name"},{mData:"creationTime"}],columnDefs:[{targets:0,visible:false,searchable:false},{render:function(e){return moment(e).format("MMM DD, YYYY hh:mm:ss A")},targets:2}],order:[[1,"asc"]]});b.on("select",function(i,h,g,f){listSelectAction(h,f)});b.on("deselect",function(i,h,g,f){disableButtonsAtStep1()});c.on("select",function(i,h,g,f){listSelectAction(h,f)});c.on("deselect",function(i,h,g,f){disableButtonsAtStep1()});$(a).click(function(){var e=$(this).attr("id");if(e!==datatype){datatype=e;switch(datatype){case"single":datatable=b;$('input:hidden[name="singleFile"]').val(true);break;case"multiple":datatable=c;$('input:hidden[name="singleFile"]').val(false);break}updateTable()}});$(d).click(function(){var e=$(this).val();if(e!==vartype){vartype=e;updateTable()}});$('input:radio[name="algoType"]').click(function(){fetchAlgorithms($(this).val())});$("#algorithm").change(function(){var e=$("#algorithm :selected").val();var f=$("input[name=varTypeId]:checked").val();fetchScores(e,f);fetchTests(e,f);fetchDescription(e);$("#step4btn").prop("disabled",true)});$("#score").change(function(){$("#step4btn").prop("disabled",true)});$("#test").change(function(){$("#step4btn").prop("disabled",true)});$("#step1btn").click(function(f){step_btn=$(this).attr("id")});$("#step2btn").click(function(f){if(step_btn==="step1btn"){$("#algorithm").trigger("change")}step_btn=$(this).attr("id");$('input:radio[name="algoType"]:checked').click()});$("#step3btn").click(function(f){if(step_btn==="step2btn"){fetchParameters()}step_btn=$(this).attr("id")});$("#step4btn").click(function(f){if(step_btn==="step4btn"){return}updateParamSummary();step_btn=$(this).attr("id")});datatable=b;datatype=$(a).attr("id");vartype=$(d).filter(":checked").val();$('input:radio[name="algoType"]:checked').click();$('input:hidden[name="singleFile"]').val(true);updateTable();disableButtonsAtStep1()});